generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql" 
}

enum deploymentStatus {
  PENDING
  BUILDING
  DEPLOYED
  FAILED
  SUPERSEDED
}

model User {
  id              String          @id @default(uuid())
  firstName       String
  lastName        String          @default("")
  email           String          @unique
  password        String
  refreshToken    String?

  projects        Project[]

  createdAt       DateTime        @default(now())
  updatedAt       DateTime        @updatedAt
}

model Project {
  id               String           @id @default(uuid())
  name             String
  gitRepoUrl       String
  
  deployedUrl      String           @default("")
  envObject        Json?     

  userId           String
  user             User             @relation(fields: [userId], references: [id])

  deployments      Deployment[]

  createdAt        DateTime         @default(now())
  updatedAt        DateTime         @updatedAt
}

model Deployment {
  id               String               @id @default(uuid())
  status           deploymentStatus

  projectId        String
  project          Project              @relation(fields: [projectId], references: [id], onDelete: Cascade)

  createdAt        DateTime             @default(now())
  updatedAt        DateTime             @updatedAt
}

